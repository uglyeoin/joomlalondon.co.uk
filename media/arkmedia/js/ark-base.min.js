(function(n){var t=function(n){this.initialise(n)};t.prototype={constructor:t,options:{css:{base:"html, body",root:"#ark",actions:"#ark-actions",content:"#ark-content",editbox:"#ark-edit",stack:"[data-stack]",edit:"[data-edit]",item:'#ark-content [data-stack="%s"] [data-view="%s"] [data-select="%s"]',hide:{value:"var-hide",css:".var-hide"},block:{value:"var-block",css:".var-block"},bootstrap:{button:{value:"btn",selector:".btn"},active:{value:"active",selector:".active"},hide:{value:"hidden",selector:".hidden"},show:{value:"show ",selector:".show "}}},data:{data:"data-",id:"data-id",name:"data-name",stack:"data-stack",action:{value:"action",data:"data-action"},value:{value:"value",data:"data-value"},edit:{value:"edit",data:"data-edit"},type:{value:"type",data:"data-type"},key:{value:"key",data:"data-key"}},html:{blank:"--",dash:" - ",quote:'"%s"',date:"DD/MM/YYYY HH:mm:ss",messages:{feature:{soon:"Coming Soon!",upgrade:"Upgrade!",plugin:"Check Plugin!"}},errors:{generic:"Error!",data:"No Data!",path:"No Path!",action:"No Action!",form:"No Form!",permission:"No Access!",cancel:"Cancelled!"},ds:"/",url:"",sprintf:/%s/},namespace:".base",view:null,text:{prefix:null},escape:{global:"g",caseinsensitive:"i",fullstop:".",asterisk:"*",plus:"+",questionmark:"?",caret:"^",dollar:"$",curlybrackets:"{}",roundbrackets:"()",squarebrackets:"\\[\\]",pipe:"|",backslash:"\\/",forwardslash:"\\\\"},id:{alpha:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",numeric:"0123456789",special:"-_!#*()[]{}@:?",length:4,count:1},trim:{mask:" "},extension:{lower:!0},fields:{group:!0},find:{root:"",path:"",view:null,group:"views"},highlight:{view:null,group:"views",delay:0,select:!0,base:"",scroll:!0,offset:150,animate:600,flash:150,wigglelimit:5,wigglespeed:25,scrollbar:!1},message:{winks:{fastest:500,faster:1e3,fast:2e3,slow:5e3,slower:7e3,slowest:1e4},wink:3e3,type:"error",position:"top",queue:!0,max:3,close:["button"],tmpl:"ark-noty",buttons:null,translate:{on:!1,prefix:!0,revalue:!1}},confirmbox:{position:"center",wink:!1,type:"message",yes:{css:"btn btn-success",text:"Ok",callback:"base:confirm:yes"},no:{css:"btn",text:"Cancel",callback:"base:confirm:no"}},promptbox:{position:"center",wink:!1,type:"message",yes:{css:"btn btn-success",text:"Ok",callback:"base:prompt:yes"},no:{css:"btn",text:"Cancel",callback:"base:prompt:no"}},debug:!0,permissions:{},browser:{root:""}},el:{},initialise:function(){},root:function(){return t.prototype},set:function(t){var i=this.root().options,r=jQuery.fn.arkoptions(),u=this.options?this.options:{},f=t?t:{};return this.options=n.extend(!0,{},i,r,u,f),this.options},text:function(t,i,r){var u=r?n.extend({},this.options.text,r):this.options.text,f=u.prefix===!0?this.options.text.prefix:u.prefix,e=f?f+t:t;return Joomla.JText._(e,i||"")},escape:function(t,i){var f=i?n.extend({},this.options.escape,i):this.options.escape,r="",u="",e=["global","caseinsensitive"];return n.each(f,function(t,i){n.inArray(t,e)===-1?r+=i:u+=i}),r=new RegExp("(["+r+"])",u),t.replace(r,"\\$1")},safe:function(n){return n.replace(/[!"#$%&'()*+,.\/:;<=>?@\[\\\]^`{|}~]/g,"\\$&")},id:function(t){var i=t?n.extend({},this.options.id,t):this.options.id,r=[],u;if(i.length&&(i.alpha||i.numeric||i.special)){while(r.length<i.count)u=this._id(i.length,i.alpha,i.numeric,i.special),n.inArray(u,r)===-1&&r.push(u);return i.count>1?r:r[0]}return""},_id:function(n,t,i,r){var u=[],f,s;u.push(t);u.push(i);u.push(r);var e=u.join(""),h=e.length,o="";for(f=1;f<=n;f++)s=Math.floor(Math.random()*h),o+=e[s];return o},trim:function(t,i){var r;return(r=typeof i=="string"?{mask:i}:i?n.extend({},this.options.trim,i):this.options.trim,r.mask===" ")?n.trim(t):t.replace(new RegExp("^["+r.mask+"]+"),"").replace(new RegExp("["+r.mask+"]+$"),"")},extension:function(t,i){var f=i?n.extend({},this.options.extension,i):this.options.extension,r=t?t.split("."):[],u=r.length>1?r.pop():"";return f.lower?u.toLowerCase():u},toURL:function(n){var t="/",i;return this.options.html.ds!==t?(i=new RegExp(this.escape(this.options.html.ds),"g"),n.replace(i,t)):n},fields:function(t,i){var r={},u=i?n.extend({},this.options.fields,i):this.options.fields;return n.each(n(t).serializeArray(),function(){var n=this.name,i,t;if(u.groups===!1)for(i=n.split("["),t="";t=i.pop();)if(t!=="]"){n=t.replace("]","");break}r[n]!==undefined?(r[n].push||(r[n]=[r[n]]),r[n].push(this.value||"")):r[n]=this.value||""}),r},toArray:function(t){return n.type(t)==="object"?n.map(t,function(n){return[n]}):n.type(t)==="array"?t:[t]},exists:function(n){return n===document.body?!0:document.body.contains(n)},find:function(t,i,r){if(!t||!i)return!1;var u=r?n.extend({},this.options.find,r):this.options.find,e=n(u.root||this.options.css.root),o=u.view||n(document).triggerHandler("arkcollapse:request:value",{group:u.group})||this.options.view,f=u.path||this.options.css.item;return f=f.replace(this.options.html.sprintf,t).replace(this.options.html.sprintf,o).replace(this.options.html.sprintf,this.safe(i)),e.find(f)},onscreen:function(t,i,r){var e,u,o,s,f,c,h;return((i===null||typeof i=="undefined")&&(i=1),(r===null||typeof r=="undefined")&&(r=1),e=n(window),u={top:e.scrollTop(),left:e.scrollLeft()},u.right=u.left+e.width(),u.bottom=u.top+e.height(),o=t.outerHeight(),s=t.outerWidth(),!s||!o)?!1:(f=t.offset(),f.right=f.left+s,f.bottom=f.top+o,c=!(u.right<f.left||u.left>f.right||u.bottom<f.top||u.top>f.bottom),!c)?!1:(h={top:Math.min(1,(f.bottom-u.top)/o),bottom:Math.min(1,(u.bottom-f.top)/o),left:Math.min(1,(f.right-u.left)/s),right:Math.min(1,(u.right-f.left)/s)},h.left*h.right>=i&&h.top*h.bottom>=r)},highlight:function(t,i,r,u,f){if(!t||!i||!r||!u)return!1;var e=f?n.extend({},this.options.highlight,f):this.options.highlight,o=e.view||n(document).triggerHandler("arkcollapse:request:value",{group:e.group});return n(document).delay(e.delay).queue(n.proxy(function(r){var f,s,h;if(e.view&&n(document).triggerHandler("arkcollapse:request:toggle",{value:e.view,group:e.group}),e.select&&t)switch(t){case"folder":case"folders":n(document).triggerHandler("observer:request:active",{type:"folders",stack:i,value:[u]});n(document).triggerHandler("observer:request:active",{type:"files",stack:i,value:[]});break;case"file":case"files":n(document).triggerHandler("observer:request:active",{type:"folders",stack:i,value:[]});n(document).triggerHandler("observer:request:active",{type:"files",stack:i,value:[u]})}f=this.find(i,u,{view:o});s=n(e.base||this.options.css.base);f.length&&s.length&&(e.scroll&&!this.onscreen(f)&&(h=Math.round(f.offset().top-parseInt(e.offset)),s.animate({scrollTop:h},e.animate)),s.promise().then(n.proxy(function(){o==="list"?f.fxFlash({speed:e.flash}):f.fxWiggle("start",{limit:e.wigglelimit,delay:e.wigglespeed})},this)),e.scrollbar&&n(document).triggerHandler("explorer:request:rescroll",{stack:i}),r())},this)),!0},message:function(t,i,r){var e;if(t)if(e=!1,i&&(e=i==="alert"?!0:e,r=r||{},r.type=i,r.type=i==="info"?"information":r.type,r.type=i==="message"?"alert":r.type),e||typeof noty!="function")alert(t);else{n.type(r)==="object"&&n.type(r.wink)==="string"&&(r.wink=this.options.message.winks[r.wink]||"");var u=r?n.extend({},this.options.message,r):this.options.message,f={text:t,type:n.inArray(u.type,["alert","success","error","warning","information","confirm","preloader"])!==-1?u.type:this.options.message.type,timeout:n.isNumeric(u.wink)||u.wink===!1?u.wink:this.options.message.wink,layout:n.inArray(u.position,["top","topLeft","topCenter","topRight","centerLeft","center","centerRight","bottomLeft","bottomCenter","bottomRight","bottom"])?u.position:this.options.message.position,dismissQueue:n.type(u.queue)==="boolean"?u.queue:this.options.message.queue,maxVisible:n.isNumeric(u.max)?u.max:this.options.message.max,closeWith:n.isArray(u.close)?u.close:this.options.message.close,theme:u.tmpl||this.options.message.tmpl,buttons:u.buttons&&u.buttons.length?u.buttons:null};return u.translate.on&&(f.text=this.text(f.text,u.translate.revalue?f.text:"",{prefix:u.translate.prefix})),u.el&&n(u.el).length?n(u.el).noty(f):noty(f)}},confirmbox:function(t,i,r){var u=r?n.extend(!0,{},this.options.confirmbox,r):this.options.confirmbox;i=i||u.type;u.buttons=[{addClass:u.yes.css,text:u.yes.text,onClick:function(t){t.close();u.yes.callback&&n(document).trigger(u.yes.callback)}},{addClass:u.no.css,text:u.no.text,onClick:function(t){t.close();u.no.callback&&n(document).trigger(u.no.callback)}}];this.message(t,i,u)},promptbox:function(t,i,r,u){var f=u?n.extend(!0,{},this.options.promptbox,u):this.options.promptbox;r=r||f.type;i=i||"";t=t+'<br /><br /><input type="text" name="" value="'+i+'" />';f.buttons=[{addClass:f.yes.css,text:f.yes.text,onClick:function(t){t.close();f.yes.callback&&n(document).trigger(f.yes.callback)}},{addClass:f.no.css,text:f.no.text,onClick:function(t){t.close();f.no.callback&&n(document).trigger(f.no.callback)}}];this.message(t,r,f)},preloader:function(n,t){arguments.callee._preloader&&arguments.callee._preloader.closed&&(arguments.callee._preloader=null);n=n||(arguments.callee._preloader?"off":"on");t=t||{};msg=t.message||this.options.html.messages.loading;t.position=t.position||"bottomCenter";t.wink=t.wink||!1;n!=="on"||arguments.callee._preloader?n==="off"&&arguments.callee._preloader?(arguments.callee._preloader.close(),arguments.callee._preloader=null):n==="update"&&arguments.callee._preloader&&arguments.callee._preloader.setText(msg):arguments.callee._preloader=this.message(msg,"preloader",t)},debug:function(n,t,i){this.options.debug&&window.console&&(i=i&&window.console[i]?i:"warn",t?window.console[i](n+"() : "+t):window.console[i](n+"() : "+this.options.html.errors.generic))},permission:function(n){return this.options.permissions.hasOwnProperty(n)?this.options.permissions[n]:!1},browser:function(t,i){var e=i?n.extend({},this.options.browser,i):this.options.browser,o=n(e.root||this.options.css.root),u=o.attr("class").split(" ");if(t){var r,f="";return r=n.inArray(t,["platform","browser","major","minor"])!==-1?"nav-"+t+"-":"",r=n.inArray(t,["id","template","club"])!==-1?"tmpl-"+t+"-":r,n.each(u,function(n,t){if(t.indexOf(r)===0)return f=t.replace(r,""),!1}),f}return u}};jQuery.fn.arkbase=function(n){return new t(n)};jQuery.fn.arkoptions=function(t){return arguments.callee._options=arguments.callee._options||{},typeof t=="object"&&n.extend(!0,arguments.callee._options,t),arguments.callee._options}})(window.jQuery)