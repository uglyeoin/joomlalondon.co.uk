/*! nanoScrollerJS - v0.8.4 - 2014
* http://jamesflorentino.github.com/nanoScrollerJS/
* Copyright (c) 2014 James Florentino; Licensed MIT */
(function(n){return typeof define=="function"&&define.amd?define(["jquery"],function(t){return n(t,window,document)}):n(jQuery,window,document)})(function(n,t,i){"use strict";var a,u,o,s,v,y,ct,lt,p,w,b,k,f,d,it,h,r,at,g,e,rt,c,ut,ft,et,ot,nt,tt,st,ht,l;ut={paneClass:"nano-pane",sliderClass:"nano-slider",contentClass:"nano-content",iOSNativeScrolling:!1,preventPageScrolling:!1,disableResize:!1,alwaysVisible:!1,flashDelay:1500,sliderMinHeight:20,sliderMaxHeight:null,documentContext:null,windowContext:null};at="scrollbar";r="scroll";p="mousedown";w="mouseenter";b="mousemove";f="mousewheel";k="mouseup";h="resize";v="drag";y="enter";e="up";it="panedown";o="DOMMouseScroll";s="down";rt="wheel";ct="keydown";lt="keyup";g="touchmove";a=t.navigator.appName==="Microsoft Internet Explorer"&&/msie 7./i.test(t.navigator.appVersion)&&t.ActiveXObject;u=null;nt=t.requestAnimationFrame;c=t.cancelAnimationFrame;st=i.createElement("div").style;l=function(){var n,r,f,t,i,u;for(t=["t","webkitT","MozT","msT","OT"],n=i=0,u=t.length;i<u;n=++i)if(f=t[n],r=t[n]+"ransform",r in st)return t[n].substr(0,t[n].length-1);return!1}();ht=function(n){return l===!1?!1:l===""?n:l+n.charAt(0).toUpperCase()+n.substr(1)};tt=ht("transform");et=tt!==!1;ft=function(){var n,t,u;return n=i.createElement("div"),t=n.style,t.position="absolute",t.width="100px",t.height="100px",t.overflow=r,t.top="-9999px",i.body.appendChild(n),u=n.offsetWidth-n.clientWidth,i.body.removeChild(n),u};ot=function(){var i,r,n;return(r=t.navigator.userAgent,i=/(?=.+Mac OS X)(?=.+Firefox)/.test(r),!i)?!1:(n=/Firefox\/\d{2}\./.exec(r),n&&(n=n[0].replace(/\D+/g,"")),i&&+n>23)};d=function(){function l(r,f){this.el=r;this.options=f;u||(u=ft());this.$el=n(this.el);this.doc=n(this.options.documentContext||i);this.win=n(this.options.windowContext||t);this.body=this.doc.find("body");this.$content=this.$el.children("."+f.contentClass);this.$content.attr("tabindex",this.options.tabIndex||0);this.content=this.$content[0];this.previousPosition=0;this.options.iOSNativeScrolling&&this.el.style.WebkitOverflowScrolling!=null?this.nativeScrolling():this.generate();this.createEvents();this.addEvents();this.reset()}return l.prototype.preventScrolling=function(n,t){if(this.isActive)if(n.type===o)(t===s&&n.originalEvent.detail>0||t===e&&n.originalEvent.detail<0)&&n.preventDefault();else if(n.type===f){if(!n.originalEvent||!n.originalEvent.wheelDelta)return;(t===s&&n.originalEvent.wheelDelta<0||t===e&&n.originalEvent.wheelDelta>0)&&n.preventDefault()}},l.prototype.nativeScrolling=function(){this.$content.css({WebkitOverflowScrolling:"touch"});this.iOSNativeScrolling=!0;this.isActive=!0},l.prototype.updateScrollValues=function(){var n,t;n=this.content;this.maxScrollTop=n.scrollHeight-n.clientHeight;this.prevScrollTop=this.contentScrollTop||0;this.contentScrollTop=n.scrollTop;t=this.contentScrollTop>this.previousPosition?"down":this.contentScrollTop<this.previousPosition?"up":"same";this.previousPosition=this.contentScrollTop;t!=="same"&&this.$el.trigger("update",{position:this.contentScrollTop,maximum:this.maxScrollTop,direction:t});this.iOSNativeScrolling||(this.maxSliderTop=this.paneHeight-this.sliderHeight,this.sliderTop=this.maxScrollTop===0?0:this.contentScrollTop*this.maxSliderTop/this.maxScrollTop)},l.prototype.setOnScrollStyles=function(){var n;et?(n={},n[tt]="translate(0, "+this.sliderTop+"px)"):n={top:this.sliderTop};nt?(c&&this.scrollRAF&&c(this.scrollRAF),this.scrollRAF=nt(function(t){return function(){return t.scrollRAF=null,t.slider.css(n)}}(this))):this.slider.css(n)},l.prototype.createEvents=function(){this.events={down:function(n){return function(t){return n.isBeingDragged=!0,n.offsetY=t.pageY-n.slider.offset().top,n.slider.is(t.target)||(n.offsetY=0),n.pane.addClass("active"),n.doc.bind(b,n.events[v]).bind(k,n.events[e]),n.body.bind(w,n.events[y]),!1}}(this),drag:function(n){return function(t){return n.sliderY=t.pageY-n.$el.offset().top-n.paneTop-(n.offsetY||n.sliderHeight*.5),n.scroll(),n.contentScrollTop>=n.maxScrollTop&&n.prevScrollTop!==n.maxScrollTop?n.$el.trigger("scrollend"):n.contentScrollTop===0&&n.prevScrollTop!==0&&n.$el.trigger("scrolltop"),!1}}(this),up:function(n){return function(){return n.isBeingDragged=!1,n.pane.removeClass("active"),n.doc.unbind(b,n.events[v]).unbind(k,n.events[e]),n.body.unbind(w,n.events[y]),!1}}(this),resize:function(n){return function(){n.reset()}}(this),panedown:function(n){return function(t){return n.sliderY=(t.offsetY||t.originalEvent.layerY)-n.sliderHeight*.5,n.scroll(),n.events.down(t),!1}}(this),scroll:function(n){return function(t){(n.updateScrollValues(),n.isBeingDragged)||(n.iOSNativeScrolling||(n.sliderY=n.sliderTop,n.setOnScrollStyles()),t!=null)&&(n.contentScrollTop>=n.maxScrollTop?(n.options.preventPageScrolling&&n.preventScrolling(t,s),n.prevScrollTop!==n.maxScrollTop&&n.$el.trigger("scrollend")):n.contentScrollTop===0&&(n.options.preventPageScrolling&&n.preventScrolling(t,e),n.prevScrollTop!==0&&n.$el.trigger("scrolltop")))}}(this),wheel:function(n){return function(t){var i;if(t!=null)return i=t.delta||t.wheelDelta||t.originalEvent&&t.originalEvent.wheelDelta||-t.detail||t.originalEvent&&-t.originalEvent.detail,i&&(n.sliderY+=-i/3),n.scroll(),!1}}(this),enter:function(n){return function(t){var i;if(n.isBeingDragged)return(t.buttons||t.which)!==1?(i=n.events)[e].apply(i,arguments):void 0}}(this)}},l.prototype.addEvents=function(){var n;this.removeEvents();n=this.events;this.options.disableResize||this.win.bind(h,n[h]);this.iOSNativeScrolling||(this.slider.bind(p,n[s]),this.pane.bind(p,n[it]).bind(""+f+" "+o,n[rt]));this.$content.bind(""+r+" "+f+" "+o+" "+g,n[r])},l.prototype.removeEvents=function(){var n;n=this.events;this.win.unbind(h,n[h]);this.iOSNativeScrolling||(this.slider.unbind(),this.pane.unbind());this.$content.unbind(""+r+" "+f+" "+o+" "+g,n[r])},l.prototype.generate=function(){var s,n,e,i,o,r,f;return i=this.options,r=i.paneClass,f=i.sliderClass,s=i.contentClass,(o=this.$el.children("."+r)).length||o.children("."+f).length||this.$el.append('<div class="'+r+'"><div class="'+f+'" /><\/div>'),this.pane=this.$el.children("."+r),this.slider=this.pane.find("."+f),u===0&&ot()?(e=t.getComputedStyle(this.content,null).getPropertyValue("padding-right").replace(/[^0-9.]+/g,""),n={right:-14,paddingRight:+e+14}):u&&(n={right:-u},this.$el.addClass("has-scrollbar")),n!=null&&this.$content.css(n),this},l.prototype.restore=function(){this.stopped=!1;this.iOSNativeScrolling||this.pane.show();this.addEvents()},l.prototype.reset=function(){var n,o,s,h,f,y,c,i,l,e,v,t;if(this.iOSNativeScrolling){this.contentHeight=this.content.scrollHeight;return}return this.$el.find("."+this.options.paneClass).length||this.generate().stop(),this.stopped&&this.restore(),n=this.content,h=n.style,f=h.overflowY,a&&this.$content.css({height:this.$content.height()}),o=n.scrollHeight+u,e=parseInt(this.$el.css("max-height"),10),e>0&&(this.$el.height(""),this.$el.height(n.scrollHeight>e?e:n.scrollHeight)),c=this.pane.outerHeight(!1),l=parseInt(this.pane.css("top"),10),y=parseInt(this.pane.css("bottom"),10),i=c+l+y,t=Math.round(i/o*i),t<this.options.sliderMinHeight?t=this.options.sliderMinHeight:this.options.sliderMaxHeight!=null&&t>this.options.sliderMaxHeight&&(t=this.options.sliderMaxHeight),f===r&&h.overflowX!==r&&(t+=u),this.maxSliderTop=i-t,this.contentHeight=o,this.paneHeight=c,this.paneOuterHeight=i,this.sliderHeight=t,this.paneTop=l,this.slider.height(t),this.events.scroll(),this.pane.show(),this.isActive=!0,n.scrollHeight===n.clientHeight||this.pane.outerHeight(!0)>=n.scrollHeight&&f!==r?(this.pane.hide(),this.isActive=!1):this.el.clientHeight===n.scrollHeight&&f===r?this.slider.hide():this.slider.show(),this.pane.css({opacity:this.options.alwaysVisible?1:"",visibility:this.options.alwaysVisible?"visible":""}),s=this.$content.css("position"),(s==="static"||s==="relative")&&(v=parseInt(this.$content.css("right"),10),v&&this.$content.css({right:"",marginRight:v})),this},l.prototype.scroll=function(){if(this.isActive)return this.sliderY=Math.max(0,this.sliderY),this.sliderY=Math.min(this.maxSliderTop,this.sliderY),this.$content.scrollTop(this.maxScrollTop*this.sliderY/this.maxSliderTop),this.iOSNativeScrolling||(this.updateScrollValues(),this.setOnScrollStyles()),this},l.prototype.scrollBottom=function(n){if(this.isActive)return this.$content.scrollTop(this.contentHeight-this.$content.height()-n).trigger(f),this.stop().restore(),this},l.prototype.scrollTop=function(n){if(this.isActive)return this.$content.scrollTop(+n).trigger(f),this.stop().restore(),this},l.prototype.scrollTo=function(n){if(this.isActive)return this.scrollTop(this.$el.find(n).get(0).offsetTop),this},l.prototype.stop=function(){return c&&this.scrollRAF&&(c(this.scrollRAF),this.scrollRAF=null),this.stopped=!0,this.removeEvents(),this.iOSNativeScrolling||this.pane.hide(),this},l.prototype.destroy=function(){return this.stopped||this.stop(),!this.iOSNativeScrolling&&this.pane.length&&this.pane.remove(),a&&this.$content.height(""),this.$content.removeAttr("tabindex"),this.$el.hasClass("has-scrollbar")&&(this.$el.removeClass("has-scrollbar"),this.$content.css({right:""})),this},l.prototype.flash=function(){if(!this.iOSNativeScrolling)return this.isActive?(this.reset(),this.pane.addClass("flashed"),setTimeout(function(n){return function(){n.pane.removeClass("flashed")}}(this),this.options.flashDelay),this):void 0},l}();n.fn.nanoScroller=function(t){return this.each(function(){var r,i;if((i=this.nanoscroller)||(r=n.extend({},ut,t),this.nanoscroller=i=new d(this,r)),t&&typeof t=="object"){if(n.extend(i.options,t),t.scrollBottom!=null)return i.scrollBottom(t.scrollBottom);if(t.scrollTop!=null)return i.scrollTop(t.scrollTop);if(t.scrollTo)return i.scrollTo(t.scrollTo);if(t.scroll==="bottom")return i.scrollBottom(0);if(t.scroll==="top")return i.scrollTop(0);if(t.scroll&&t.scroll instanceof n)return i.scrollTo(t.scroll);if(t.stop)return i.stop();if(t.destroy)return i.destroy();if(t.flash)return i.flash()}return i.reset()})};n.fn.nanoScroller.Constructor=d})