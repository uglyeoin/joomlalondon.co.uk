(function(n){var t=function(n){this.initialise(n)};t.prototype=n.extend({},n.fn.arkbase(),{constructor:t,options:{css:{form:"#form-subactions-deleteitems",stack:"#stack-subactions-deleteitems",path:"#path-subactions-deleteitems",folders:"#folders-subactions-deleteitems",files:"#files-subactions-deleteitems",control:"#ctrl-subactions-deleteitems"},html:{errors:{confirm:{all:"Proceed?",folders:"Proceed?",folder:"Proceed?",files:"Proceed?",file:"Proceed?"},path:"No Path!",select:"No Folders or File!"}},namespace:".deleteitems",confirm:!0},active:!0,el:{root:null,form:null,stack:null,path:null,folders:null,files:null,controls:null},initialise:function(t){if(this.set(t),this.el.root=n(this.options.css.root),this.el.form=this.el.root.find(this.options.css.form),this.el.controls=this.el.root.find(this.options.css.control),this.el.stack=this.el.form.find(this.options.css.stack),this.el.path=this.el.form.find(this.options.css.path),this.el.folders=this.el.form.find(this.options.css.folders),this.el.files=this.el.form.find(this.options.css.files),n.views){if(!this.el.form)return this.message('"Delete Items" Functionality Error'),this.debug("initialise","Delete Items Form Element Not Found"),!1}else return this.message("Dependent Classes Not Found"),this.debug("initialise","Dependent Classes Not Found"),!1;this.addFormEvents();this.requests();this.toggle()},addFormEvents:function(){n(document).trigger("deleteitems:before:event",[this.el.form]);n(this.el.controls).on("click"+this.options.namespace,n.proxy(function(){this.submit()},this));n(this).delay(0).queue(function(){var t=n(document).triggerHandler("observer:request:all"),i=n(document).triggerHandler("observer:request:active",{type:"stack"});n.each(t,n.proxy(function(t){var i=n(document).triggerHandler("observer:request:active",{type:"folders",stack:t}),r=n(document).triggerHandler("observer:request:active",{type:"files",stack:t});n.observe(i,r,n.proxy(function(){this.toggle(i,r)},this))},this));n.observe(i,"*",n.proxy(function(t){var i=n(document).triggerHandler("observer:request:active",{type:"folders",stack:t.target.value}),r=n(document).triggerHandler("observer:request:active",{type:"files",stack:t.target.value});this.toggle(i,r)},this));n(this).dequeue});n(document).trigger("deleteitems:after:event",[this.el.form])},submit:function(){var u;if(n(document).trigger("deleteitems:before:submit",[this.el.form]),!this.active)return this.message(this.options.html.errors.permission,"error"),this.debug("submit","The Delete Logic is Currently Disabled."),!1;var r=n(document).triggerHandler("observer:request:active",{type:"stack"}),f=n(document).triggerHandler("observer:request:active",{type:"path",stack:r.value}),t=n(document).triggerHandler("observer:request:active",{type:"folders",stack:r.value}),i=n(document).triggerHandler("observer:request:active",{type:"files",stack:r.value});t.length&&!i.length?u=t.length>1?this.options.html.errors.confirm.folders.replace("%s",t.length):this.options.html.errors.confirm.folder.replace("%s",t[0]):!t.length&&i.length?u=i.length>1?this.options.html.errors.confirm.files.replace("%s",i.length):this.options.html.errors.confirm.file.replace("%s",i[0]):t.length&&i.length&&(u=this.options.html.errors.confirm.all.replace("%foldercount",t.length).replace("%filecount",i.length));r.value&&f.path&&this.el.stack&&this.el.path?this.el.folders&&this.el.files?t.length+i.length?this.options.confirm&&!confirm(u)?this.debug("submit","Delete Process Not Confirmed by User"):typeof JSON=="object"?(this.el.stack.val(r.value),this.el.path.val(f.path),this.el.folders.val(JSON.stringify(t)),this.el.files.val(JSON.stringify(i)),n(this.el.form).submit()):(this.message(this.options.html.errors.support,"error",{wink:"slowest"}),this.debug("submit","The JSON Library is Not Available")):(this.message(this.options.html.errors.select,"warning"),this.debug("submit","No Count of Folders & Files Observers")):(this.message(this.options.html.errors.generic,"error",{wink:"slower"}),this.debug("submit","The Folders/Files Input Could Not Be Found")):(this.message(this.options.html.errors.path),this.debug("submit","The Observer Active Stack Path Could Not be Found"));n(document).trigger("deleteitems:after:submit",[this.el.form])},toggle:function(t,i){n(document).trigger("deleteitems:before:toggle",[t,i]);t=n.isArray(t)?t:[];i=n.isArray(i)?i:[];t.length||i.length?n(document).triggerHandler("deleteitems:request:state",{type:"on"}):n(document).triggerHandler("deleteitems:request:state",{type:"off"});n(document).trigger("deleteitems:after:toggle",[t,i])},requests:function(){n(document).on("deleteitems:request:state",n.proxy(function(n,t){t.type==="on"?(this.active=!0,this.el.controls.removeAttr("disabled")):(this.active=!1,this.el.controls.attr("disabled","disabled"))},this))}});n.fn.deleteitems=function(n){return new t(n)}})(window.jQuery)