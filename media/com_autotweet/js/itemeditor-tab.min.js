"use strict";angular.module("starter.helper",[]).factory("ItemEditorHelper",function(){var n=null,i=null,ItemEditorHelper={POSTTHIS_DEFAULT:1,POSTTHIS_NO:2,POSTTHIS_YES:3,setHtmlAdvancedAttrs:function(t){var e,a;return(a=i.document.getElementById("autotweet_advanced_attrs"))?(t=JSON.stringify(t),a.value=t):(a='<input type="hidden" id="autotweet_advanced_attrs" name="autotweet_advanced_attrs" value="'+(t=_.escape(JSON.stringify(t)))+'">',(e=i.jQuery("form[name=adminForm]")).length||(e=i.jQuery("form[name=submissionForm]")).length||(e=i.jQuery("form[name=composer]")),1==e.length?e.append(a):alert("Joocial - Form not found or more than one.")),!0},getHtmlAdvancedAttrs:function(){var t,e;return(t=i.document.getElementById("autotweet_advanced_attrs"))&&!_.isEmpty(t.value)?(e=t.value,e=JSON.parse(_.unescape(e))):null},getHtmlEditorText:function(){var t,e;return i.tinymce&&i.tinymce.activeEditor?(e=i.tinymce.activeEditor.getContent(),_.isEmpty(e)&&(e=i.tinymce.editors[0].getContent()),e):(t=i.document.getElementById("jform_articletext"))?t.value:null},setHtmlPanel:function(t,e){var a,n;return(a=i.jQuery("#item-form #myTabContent")).length?(ItemEditorHelper.addHtmlTab(e),ItemEditorHelper.addHtmlPanel(a,t),!0):(a=i.jQuery(".item-page #adminForm .tab-content")).length?(ItemEditorHelper.addHtmlTab(e),ItemEditorHelper.addHtmlPanel(a,t),!0):(a=i.jQuery(".request-edit #qContent")).length?(ItemEditorHelper.addHtmlTab(e),ItemEditorHelper.addHtmlPanel(a,t),(n=i.jQuery("#filterconditions-tab a")).length&&n.tab("show"),!0):(a=i.jQuery("#adminFormK2Sidebar")).length?(ItemEditorHelper.addHtmlPanel(a,t),!0):(a=i.jQuery("#parameter-accordion")).length?(ItemEditorHelper.addHtmlPanel(a,t),!0):(a=i.jQuery("#item-submission")).length?(ItemEditorHelper.addHtmlPanel(a,t),!0):(a=i.jQuery("form[name=composer]")).length?(ItemEditorHelper.addHtmlPanel(a,t),!0):(a=i.jQuery("#eblog-wrapper #options")).length?(ItemEditorHelper.addHtmlPanel(a,t),!0):(a=i.jQuery("#widget-writepost .ui-modbody")).length?(ItemEditorHelper.addHtmlPanel(a,t),!0):(a=i.jQuery("#fcform_tabset_0")).length?(ItemEditorHelper.addHtmlPanel(a,t),a.height("100%"),!0):(a=i.jQuery(".jr-tabs")).length?(ItemEditorHelper.addHtmlPanel(a,t),!0):(a=i.jQuery("#JCalProEventTabContent")).length?(ItemEditorHelper.addHtmlTab(e),ItemEditorHelper.addHtmlPanel(a,t),!0):(a=i.jQuery("#content")).length?(ItemEditorHelper.addHtmlPanel(a,t),!0):!!(a=i.jQuery("#element-box div.m")).length&&(ItemEditorHelper.addHtmlPanel(a,t),!0)},addHtmlPanel:function(t,e){var a;(a=i.document.getElementById("autotweet-advanced-attrs"))&&a.parentNode.removeChild(a),t.append(e)},loadPanel:function(e){if(_.isEmpty(e)&&(e=i.autotweetAdvancedAttrs),_.isEmpty(e))return!1;n?ItemEditorHelper.updatePanel(e):jQuery.ajax({url:i.autotweetPanelTemplate,dataType:"text",success:function(t){n=_.template(t),ItemEditorHelper.updatePanel(e)}})},updatePanel:function(t){var e,a;(a=_.clone(t)).autotweetUrlRoot=i.autotweetUrlRoot,e=n(a),ItemEditorHelper.setHtmlPanel(e,t.editorTitle),parent.jQuery("ul.nav-tabs li a:first").tab("show")},addHtmlTab:function(t){var e;return(e=i.jQuery("#myTabTabs")).length?(ItemEditorHelper._addHtmlTab(t,e),!0):(e=i.jQuery("#adminForm ul.nav-tabs")).length?(ItemEditorHelper._addHtmlTab(t,e),!0):(e=i.jQuery("#JCalProEventTabTabs")).length?(ItemEditorHelper._addHtmlTab(t,e),!0):!!(e=i.jQuery(".request-edit #qTypeTabs ul.nav-tabs")).length&&(ItemEditorHelper._addHtmlTab(t,e),!0)},_addHtmlTab:function(t,e){var a,n='<img src="'+i.autotweetUrlRoot+'media/com_autotweet/images/autotweet-icon.png">';i.jQuery("#myAutoTweetTab").length||(a=i.jQuery('<li id="myAutoTweetTab" class=""><a id="myAutoTweetTabToogle" href="#autotweet-advanced-attrs" data-toggle="tab">'+n+" "+t+"</a></li>"),e.append(a),i.jQuery("#myAutoTweetTabToogle").click(function(t){t.preventDefault(),_.isFunction(jQuery(this).tab)&&jQuery(this).tab("show")}))},retrieveTitle:function(){var t;return t=i.jQuery("#jform_title").val(),_.isEmpty(t)?(t=i.jQuery("#title").val(),_.isEmpty(t)?(t=i.jQuery("textarea[name=title]").val(),_.isEmpty(t)?(t=i.jQuery("#name").val(),_.isEmpty(t)?"":t):t):t):t},retrieveFulltext:function(){var t=ItemEditorHelper.getHtmlEditorText(),e=document.createElement("DIV");return e.innerHTML=t,300<(t=e.textContent||e.innerText||"").length&&(t=t.substr(0,300)+"..."),t},retrieveImages:function(){var t,e,a,n,r,l,u;return t=(t=ItemEditorHelper.getHtmlEditorText()).replace(/src/g,"data_src"),e=jQuery(t),a=[],_.each(e.find("img"),function(t){r=jQuery(t),n={src:r.attr("data_src"),alt:r.attr("alt")},a.push(n)}),l=i.jQuery("#jform_images_image_intro").val(),_.isEmpty(l)||(u=i.jQuery("#jform_images_image_intro_alt").val()||i.jQuery("#jform_images_image_intro_caption").val(),n={src:l,alt:u},a.push(n)),l=i.jQuery("#jform_images_image_fulltext").val(),_.isEmpty(l)||(u=i.jQuery("#jform_images_image_fulltext_alt").val()||i.jQuery("#jform_images_image_fulltext_caption").val(),n={src:l,alt:u},a.push(n)),l=i.jQuery(".k2AdminImage").attr("src"),_.isEmpty(l)||(l=l.slice(0,l.indexOf("_S.jpg")),u=i.jQuery("input[name=image_caption]").val(),n={src:l+"_XS.jpg",alt:u+" XS"},a.push(n),n={src:l+"_S.jpg",alt:u+" S"},a.push(n),n={src:l+"_Generic.jpg",alt:u+" Generic"},a.push(n),n={src:l+"_M.jpg",alt:u+" M"},a.push(n),n={src:l+"_L.jpg",alt:u},a.push(n),n={src:l+"_XL.jpg",alt:u+" XL"},a.push(n)),(l=i.jQuery(".image-preview img")).length&&_.each(l,function(t){n={src:t.src},t.src.toLowerCase().match(/\.(jpg|jpeg|png|gif)$/)&&a.push(n)}),l=i.jQuery(".imageData").val(),_.isEmpty(l)||(l=JSON.parse(_.unescape(l)),n={src:l.url,alt:l.title},a.push(n)),l=i.jQuery("input[name=product_image]+img").attr("src"),_.isEmpty(l)||a.push({src:l}),(l=i.jQuery("#product_images_area img")).length&&_.each(l,function(t){n={src:t.src},a.push(n)}),a},setYesNo:function(t,e){var a;t&&t!=e.val()&&((a=e.parent().find("a[data-value="+t+"]")).length?a.click():(e.val(t),e.trigger("liszt:updated")))}};return window.parent.autotweetAdvancedAttrs?i=window.parent:window.autotweetAdvancedAttrs&&(i=window),ItemEditorHelper.loadPanel(),i&&ItemEditorHelper.setHtmlAdvancedAttrs(i.autotweetAdvancedAttrs),ItemEditorHelper}),angular.module("starter",["starter.helper"]).config(function($logProvider,$compileProvider){$logProvider.debugEnabled(!1),$compileProvider.debugInfoEnabled(!1)}).run(["ItemEditorHelper",function(ItemEditorHelper){}]),angular.element(document).ready(function(){angular.bootstrap(document,["starter"])});
