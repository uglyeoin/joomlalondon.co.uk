jQuery(document).ready(function(){let e={props:["localConfig","page","pluginConfig","applyscore"],template:'        <div class="test" :class="classes" :data-js-score="score">        <div class="pseo-score__content"><span :class="icon"></span>{{ message }}</div>        </div>',data:function(){return{testname:"testname",messages:["init"],weight:1,minscore:0,maxscore:5,charToASCII:{"à":"a","ô":"o","ď":"d","ḟ":"f","ë":"e","š":"s","ơ":"o","ß":"ss","ă":"a","ř":"r","ț":"t","ň":"n","ā":"a","ķ":"k","ŝ":"s","ỳ":"y","ņ":"n","ĺ":"l","ħ":"h","ṗ":"p","ó":"o","ú":"u","ě":"e","é":"e","ç":"c","ẁ":"w","ċ":"c","õ":"o","ṡ":"s","ø":"o","ģ":"g","ŧ":"t","ș":"s","ė":"e","ĉ":"c","ś":"s","î":"i","ű":"u","ć":"c","ę":"e","ŵ":"w","ṫ":"t","ū":"u","č":"c","ö":"oe","è":"e","ŷ":"y","ą":"a","ł":"l","ų":"u","ů":"u","ş":"s","ğ":"g","ļ":"l","ƒ":"f","ž":"z","ẃ":"w","ḃ":"b","å":"a","ì":"i","ï":"i","ḋ":"d","ť":"t","ŗ":"r","ä":"ae","í":"i","ŕ":"r","ê":"e","ü":"ue","ò":"o","ē":"e","ñ":"n","ń":"n","ĥ":"h","ĝ":"g","đ":"d","ĵ":"j","ÿ":"y","ũ":"u","ŭ":"u","ư":"u","ţ":"t","ý":"y","ő":"o","â":"a","ľ":"l","ẅ":"w","ż":"z","ī":"i","ã":"a","ġ":"g","ṁ":"m","ō":"o","ĩ":"i","ù":"u","į":"i","ź":"z","á":"a","û":"u","þ":"th","ð":"dh","æ":"ae","µ":"u","ĕ":"e","œ":"oe"}}},created:function(){this.$emit("score-change",{label:this.testname,score:this.score,weight:this.weight,applyscore:this.applyscore,min:this.minscore,max:this.maxscore})},watch:{score:function(){this.isVisiblyActive&&this.$emit("score-change",{label:this.testname,score:this.score,weight:this.weight,applyscore:this.applyscore,min:this.minscore,max:this.maxscore})}},computed:{message:function(){if(this.score>-1&&this.isVisiblyActive)return this.messages[this.score]},color:function(){return this.isVisiblyActive?this.score:-1},classes:function(){return this.isVisiblyActive?"seo-test"+(-1!==this.score?" score-"+this.color:""):"seo-test"},icon:function(){if(this.page.final_html.length&&this.isVisiblyActive){var e="notification";return!1!==this.applyscore&&(e=this.score===this.maxscore?"checkmark":this.score===this.minscore?"remove":"warning-2"),"icon-"+e}},isVisiblyActive:function(){return this.localConfig.focusWord.length>0}},methods:{getScores:function(){return{min:this.minscore,max:this.maxscore}},makeURISafe:function(e){let t=e;for(let e in this.charToASCII)if(this.charToASCII.hasOwnProperty(e)){let i=new RegExp(e,"g");t=t.replace(i,this.charToASCII[e])}return t=t.replace(/\b\w[’|']|\w?[’|']\b\w?\b/g,"").trim()}}};function t(e,t){return((t||"").match(new RegExp(e,"ig"))||[]).length}function i(e){let t=e.replace(/<style.*?>[^]*?<\/style>/gi,"");return(t=t.replace(/<script.*?>[^]*?<\/script>/gi,"")).replace(/<[^>]+>[^>]+<\/script+>|\&\w+;|<[^>]+>|\{[^\}]+\}/gi," ").split(" ").filter(function(e){return e.length>0}).join(" ")}function n(e){let t=Array.prototype.slice.call(arguments,1);return e.replace(/\{(\d+)\}/g,function(e,i){return void 0!==t[i]?t[i]:e})}Vue.component("test-keyword-in-title",{data:function(){return{testname:"Keyword in title",messages:[this.pluginConfig.requirements_article_title_bad,"",this.pluginConfig.requirements_article_title_good],maxscore:2}},computed:{score:function(){return this.localConfig.focusWord.length?t(this.localConfig.focusWord,this.page.title)>0?2:0:-1}},mixins:[e]}),Vue.component("test-page-title",{data:function(){return{testname:"Keyword in title",messages:[this.pluginConfig.requirements_page_title_bad,"",this.pluginConfig.requirements_page_title_good],weight:2,maxscore:2}},computed:{score:function(){return this.localConfig.focusWord.length&&this.page.pagetitle.length?t(this.localConfig.focusWord,this.page.pagetitle)>0?2:0:-1}},mixins:[e]}),Vue.component("test-page-title-length",{data:function(){return{testname:"Pagetitle length",messages:["",this.pluginConfig.requirements_page_title_length_too_few_bad,this.pluginConfig.requirements_page_title_length_too_much_bad,this.pluginConfig.requirements_page_title_length_too_few_medium,this.pluginConfig.requirements_page_title_length_too_much_medium,this.pluginConfig.requirements_page_title_length_good],weight:2}},computed:{score:function(){if(!this.page.pagetitle.length)return-1;let e=this.page.pagetitle.length;return e>=this.pluginConfig.min_title_length&&e<=this.pluginConfig.max_title_length?5:e<this.pluginConfig.min_title_length/2?1:e>1.5*this.pluginConfig.max_title_length?2:e>this.pluginConfig.max_title_length?4:3},color:function(){return this.score<3?1:this.score<5?1:2},message:function(){if(this.score>-1)return n(this.messages[this.score],this.page.pagetitle.length)},isVisiblyActive:function(){return!0}},mixins:[e]}),Vue.component("test-keyword-in-meta",{data:function(){return{testname:"Keyword in meta description",messages:[this.pluginConfig.requirements_meta_description_none,this.pluginConfig.requirements_meta_description_too_short_medium,this.pluginConfig.requirements_meta_description_too_long_medium,this.pluginConfig.requirements_meta_description_medium,this.pluginConfig.requirements_meta_description_good],maxscore:4}},computed:{score:function(){return this.localConfig.focusWord.length?0===this.page.metadesc.length?0:this.page.metadesc.length<this.pluginConfig.min_metadesc_length?1:this.page.metadesc.length>this.pluginConfig.max_metadesc_length?2:t(this.localConfig.focusWord,this.page.metadesc)>0?4:3:-1},color:function(){return this.score===this.maxscore?2:this.score===this.minscore?0:1},message:function(){if(this.score>-1)return n(this.messages[this.score],this.page.metadesc.length)}},mixins:[e]}),Vue.component("test-keyword-in-url",{data:function(){return{testname:"Keyword in url",messages:[this.pluginConfig.requirements_in_url_bad,"",this.pluginConfig.requirements_in_url_good],maxscore:2}},computed:{score:function(){if(!this.localConfig.focusWord.length||!this.page.url.length&&!this.page.new_url.length)return-1;let e=this.page.new_url||this.page.url;return-1===this.localConfig.focusWord.indexOf("-")&&(e=e.replace(/-/g," ")),t(this.makeURISafe(this.localConfig.focusWord),e)>0?2:0}},mixins:[e]}),Vue.component("test-keyword-not-used",{data:function(){return{testname:"Keyword is not used prior",messages:[this.pluginConfig.requirements_not_used_bad,this.pluginConfig.requirements_not_used_bad,this.pluginConfig.requirements_not_used_medium,this.pluginConfig.requirements_not_used_good],minscore:1,maxscore:3}},computed:{score:function(){return""!==this.page.count&&this.localConfig.focusWord.length?0===this.page.count?3:1===this.page.count?2:1:-1},color:function(){return 3===this.score?2:1}},mixins:[e]}),Vue.component("test-body-has-images",{data:function(){return{testname:"Body has images",messages:[this.pluginConfig.requirements_images_none,this.pluginConfig.requirements_images_bad,this.pluginConfig.requirements_images_good],maxscore:2}},computed:{score:function(){if(!this.page.body.length&&!this.page.final_body.length)return-1;let e=this.page.body.match(/<img[^]*?>/g)||[];return this.page.intro_image.length&&e.push('alt="'+this.page.intro_image_alt+'"'),this.page.full_image.length&&e.push('alt="'+this.page.full_image_alt+'"'),e.length?this.altDoesMatch(e)?2:1:(e=this.page.final_body.match(/<img[^]*?>/g)||[]).length&&this.altDoesMatch(e)?2:0},isVisiblyActive:function(){return!0}},methods:{altDoesMatch:function(e){if(this.localConfig.focusWord.length>0){let t=this.makeURISafe(this.localConfig.focusWord);for(let i=e.length;i--;){let n=/alt\=[\'|"]([^]*?)[\'|"]/.exec(e[i]);if(n){let e=n[1].toLowerCase();if(-1!==e.indexOf(this.localConfig.focusWord)||-1!==e.indexOf(t))return!0}}}return!1}},mixins:[e]}),Vue.component("test-body-images-have-alt",{data:function(){return{testname:"Body has images",messages:[this.pluginConfig.requirements_images_none,this.pluginConfig.requirements_images_alt_bad,this.pluginConfig.requirements_images_alt_good],maxscore:2,missingAlt:0}},computed:{score:function(){if(!this.page.body.length&&!this.page.final_body.length)return-1;let e=this.page.body.match(/<img[^]*?>/g)||[];this.page.intro_image.length&&e.push('alt="'+this.page.intro_image_alt+'"'),this.page.full_image.length&&e.push('alt="'+this.page.full_image_alt+'"');let t=0;for(let i=e.length;i--;)/alt=["'][a-zA-Z0-9]/.test(e[i])||t++;return this.missingAlt=t,t?1:2},isVisiblyActive:function(){return!0},message:function(){if(this.score>-1)return n(this.messages[this.score],this.missingAlt)}},mixins:[e]}),Vue.component("test-result-body-has-images",{data:function(){return{testname:"Resulting body has images",messages:[this.pluginConfig.requirements_images_resulting_none,this.pluginConfig.requirements_images_resulting_bad,this.pluginConfig.requirements_images_resulting_good],maxscore:2}},computed:{score:function(){return!1!==this.applyscore&&this.page.final_body.length?this.calculateScore():-1},message:function(){if(this.page.final_body.length)return this.messages[this.calculateScore()]},isVisiblyActive:function(){return!0},classes:function(){let e="seo-test",t=this.calculateScore();return this.localConfig.focusWord.length>0&&(e+=" score-"+t),e}},methods:{calculateScore:function(){let e=this.page.final_body.match(/<img[^]*?>/g)||[];if(!e.length)return 0;if(this.localConfig.focusWord.length>0){let t=this.makeURISafe(this.localConfig.focusWord);for(let i=e.length;i--;){let n=/alt\=[\'|"]([^]*?)[\'|"]/.exec(e[i]);if(n){let e=n[1].toLowerCase();if(-1!==e.indexOf(this.localConfig.focusWord)||-1!==e.indexOf(t))return 2}}}return 1}},mixins:[e]}),Vue.component("test-body-has-heading",{data:function(){return{testname:"Body has headings",messages:[this.pluginConfig.requirements_subheadings_none,this.pluginConfig.requirements_subheadings_bad,this.pluginConfig.requirements_subheadings_good],maxscore:2}},computed:{score:function(){if(!this.page.body.length)return-1;let e=this.page.body.match(/\<[h|H]\d.*?\>(.*?)\<\/[h|H]\d\>/g)||[];if(!e.length)return 0;for(let n=e.length;n--;)if(t(this.localConfig.focusWord,i(e[n])))return 2;return 1},isVisiblyActive:function(){return!0}},mixins:[e]}),Vue.component("test-body-has-paragraph-first",{data:function(){return{testname:"Body has paragraph as first element",messages:[this.pluginConfig.requirements_first_paragraph_none,this.pluginConfig.requirements_first_paragraph_bad,this.pluginConfig.requirements_first_paragraph_good],maxscore:2}},computed:{score:function(){if(!this.page.body.length||!this.localConfig.focusWord.length)return-1;let e=this.page.body.split("</p>");return e.length?(i(e[0]).match(new RegExp(this.localConfig.focusWord,"ig"))||[]).length>0?2:0:-1},message:function(){if(this.score>-1)return this.messages[this.score>0?2:1]}},mixins:[e]}),Vue.component("test-body-keyword-density",{data:function(){return{testname:"Body keyword density",messages:[this.pluginConfig.requirements_density_none,this.pluginConfig.requirements_density_too_few_bad,this.pluginConfig.requirements_density_too_much_bad,this.pluginConfig.requirements_density_too_few_medium,this.pluginConfig.requirements_density_good],density:0,timesFound:0,maxscore:4}},computed:{score:function(){if(!this.page.body.length||!this.localConfig.focusWord.length)return-1;let e=i(this.page.body.toLowerCase()),t=(e.match(/\b(\w+)\b/g)||[]).length;if(0===t)return 0;let n=new RegExp(_.escapeRegExp(this.localConfig.focusWord),"g");return this.timesFound=(e.match(n)||[]).length,this.density=(100*this.timesFound/t).toFixed(2),"0.00"===this.density?0:this.density<1?1:this.density>=1&&this.density<=3?4:(this.density,2)},color:function(){return this.score===this.maxscore?2:this.score===this.minscore?0:1},message:function(){if(this.score>-1)return n(this.messages[this.score],this.density,this.timesFound)}},mixins:[e]}),Vue.component("test-result-body-keyword-density",{data:function(){return{testname:"Resulting body keyword density",messages:[this.pluginConfig.requirements_density_none,this.pluginConfig.requirements_density_resulting_too_few_bad,this.pluginConfig.requirements_density_resulting_too_much_bad,this.pluginConfig.requirements_density_resulting_too_few_medium,this.pluginConfig.requirements_density_resulting_good],density:0,timesFound:0,maxscore:4}},computed:{score:function(){if(!this.page.final_html.length||!this.localConfig.focusWord.length)return;let e=i(this.page.final_body.toLowerCase()),t=(e.match(/\b(\w+)\b/g)||[]).length;if(0===t)return n(this.messages[0]);let s=new RegExp(_.escapeRegExp(this.localConfig.focusWord),"g");return this.timesFound=(e.match(s)||[]).length,this.density=(100*this.timesFound/t).toFixed(2),!1===this.applyscore?-1:this.calculateScore()},classes:function(){let e="seo-test",t=this.calculateScore();return this.localConfig.focusWord.length>0&&(e+=" score-"+(t===this.maxscore?2:t>0?1:0)),e},message:function(){if(this.page.final_html.length&&this.localConfig.focusWord.length)return this.score>-1?n(this.messages[this.score],this.density,this.timesFound):n(this.messages[this.calculateScore()],this.density,this.timesFound)}},methods:{calculateScore:function(){return"0.00"===this.density?0:this.density<1?1:this.density>=1&&this.density<=3?4:2}},mixins:[e]}),Vue.component("test-body-length",{data:function(){return{testname:"Body sufficient length",messages:[this.pluginConfig.requirements_length_none,this.pluginConfig.requirements_length_bad,this.pluginConfig.requirements_length_medium,this.pluginConfig.requirements_length_good],totalWords:0,minscore:1,maxscore:3}},computed:{score:function(){return this.page.body.length?(this.totalWords=_.words(i(this.page.body)).length,this.totalWords<100?1:this.totalWords>250?3:2):-1},color:function(){return 3===this.score?2:1},message:function(){if(this.score>-1)return n(this.messages[this.score],this.totalWords)},isVisiblyActive:function(){return!0}},mixins:[e]}),Vue.component("test-robots-reachable",{data:function(){return{testname:"Is page reachable for robots",messages:[this.pluginConfig.requirements_robots_reachable_bad,"",this.pluginConfig.requirements_robots_reachable_good],maxscore:2}},computed:{score:function(){if(""===this.page.reachable)return-1;if(this.page.metadata.length)for(let e=this.page.metadata.length;e--;)if(-1!==this.page.metadata[e].indexOf("robots")&&-1!==this.page.metadata[e].indexOf("noindex, ")||document.getElementById("jform_metadata_robots")&&-1!==document.getElementById("jform_metadata_robots").value.indexOf("noindex"))return 0;return this.page.reachable?2:0},isVisiblyActive:function(){return!0}},mixins:[e]}),Vue.component("test-result-article-title-unique",{data:function(){return{testname:"Article title is unique",messages:[this.pluginConfig.requirements_article_title_unique_none,this.pluginConfig.requirements_article_title_unique_good,this.pluginConfig.requirements_article_title_unique_bad]}},computed:{score:function(){return-1},classes:function(){let e="seo-test";return this.page.title.length>0&&(e+=" score-"+(this.page.title_unique?2:1)),e},message:function(){return 0===this.page.title.length?this.messages[0]:this.messages[this.page.title_unique?1:2]},isVisiblyActive:function(){return!0}},mixins:[e]}),Vue.component("test-result-page-metadesc-unique",{data:function(){return{testname:"Resulting meta description is unique",messages:[this.pluginConfig.requirements_metadesc_unique_none,this.pluginConfig.requirements_metadesc_unique_good,this.pluginConfig.requirements_metadesc_unique_bad]}},computed:{score:function(){return-1},classes:function(){let e="seo-test";return this.page.metadesc.length>0&&(e+=" score-"+(this.page.metadesc_unique?2:1)),e},message:function(){return this.page.metadesc&&0!==this.page.metadesc.length?this.messages[this.page.metadesc_unique?1:2]:this.messages[0]},isVisiblyActive:function(){return!0}},mixins:[e]}),Vue.component("test-result-loading-times",{data:function(){return{testname:"Resulting page loading times",messages:[this.pluginConfig.requirements_loading_times_ttfb]}},computed:{score:function(){return-1},message:function(){if(this.page.final_html.length)return n(this.messages[0],this.page.time_to_first_byte)},isVisiblyActive:function(){return!0}},mixins:[e]}),Vue.component("li-element",{props:{label:{type:String,required:!1},css:{type:String,required:!1}},template:'\n            <li\n            v-if="label"\n            :class="css"\n            @click="$emit(\'clicked\')">\n                {{ label }}\n            </li>\n        '}),Vue.component("test-result-most-common-words",{template:'\n        <div  class="test">\n        <div class="pseo-score__content">\n        <p :title="title()">{{ message }}</p>\n        <ul class="common-keywords">\n        <li-element :label="label(0)" :css="css(0)" @clicked="setKeyword(0)"></li-element>\n        <li-element :label="label(1)" :css="css(1)" @clicked="setKeyword(1)"></li-element>\n        <li-element :label="label(2)" :css="css(2)" @clicked="setKeyword(2)"></li-element>\n        <li-element :label="label(3)" :css="css(3)" @clicked="setKeyword(3)"></li-element>\n        <li-element :label="label(4)" :css="css(4)" @clicked="setKeyword(4)"></li-element>\n        </ul>\n        </div>\n        </div>',data:function(){return{testname:"Shows the most common words from the resulting body",messages:[this.pluginConfig.information_most_common_words],common:[],words:[]}},computed:{score:function(){return-1},message:function(){if(0===this.page.final_body.length)return;let e=this,t=i(this.page.final_body.toLowerCase()),n=e.pluginConfig.words_filter;return this.words=_(t).words().countBy().toPairs().sort(function(e,t){return e[1]-t[1]}).value(),this.common=this.words.filter(function(t){let i=t[0].trim();return!(!isNaN(parseFloat(i))&&isFinite(i))&&(!i.match(/\&\w+;/i)&&("*"!==e.localConfig.language?!n[e.localConfig.language]||-1===n[e.localConfig.language].indexOf(i):!_.find(n,function(e){return-1!==e.indexOf(i)})))}).slice(-5).reverse(),this.messages[0]}},methods:{setKeyword:function(e){let t=document.querySelector("#jform_pwtseo_focus_word");t.value=this.common[e][0],t.dispatchEvent(new Event("keyup"))},css:function(e){if(void 0!==this.common[e])return this.localConfig.focusWord===this.common[e][0]?"selected":""},label:function(e){if(void 0!==this.common[e])return this.common[e][0]+" ("+this.common[e][1]+")"},title:function(){let e=this,t=e.pluginConfig.words_filter;return this.pluginConfig.information_most_common_blocked_words+this.words.filter(function(i){let n=i[0].trim();return!(!isNaN(parseFloat(n))&&isFinite(n))&&(!n.match(/\&\w+;/i)&&("*"!==e.localConfig.language?!!t[e.localConfig.language]&&-1!==t[e.localConfig.language].indexOf(n):_.find(t,function(e){return-1!==e.indexOf(n)})))}).reverse().reduce(function(e,t){return e+"\r\n"+t[0]+" ("+t[1]+")"},"")}},mixins:[e]}),new Vue({el:"#attrib-seofieldset",data:{localConfig:{focusWord:"",editor:null,language:"*"},page:{title:"",pagetitle:"",body:"",final_body:"",final_html:"",metadesc:"",url:"",new_url:"",count:"",reachable:"",intro_image:"",intro_image_alt:"",full_image:"",full_image_alt:"",title_unique:!0,metadesc_unique:!0,metadata:[],error:"",error_global:"",time_to_first_byte:""},pluginConfig:{},scores:[],minscore:0,maxscore:0,score:0},methods:{getAjaxResponse:_.debounce(function(){this.localConfig.focusWord=_.trim(this.getValue("jform_pwtseo_focus_word").toLowerCase()),this.localConfig.language=this.getValue("jform_language")||"*";let e=jQuery("#item-form"),t=e.length?e:jQuery("#adminForm"),i=t.serializeArray();i.push({name:"group",value:"content"}),i.push({name:"plugin",value:"PWTSEOPage"}),i.push({name:"form_url",value:t.attr("action")}),i.push({name:"pwtseo_preview",value:1}),i.push({name:"context",value:this.pluginConfig.context}),i.push({name:"lang",value:this.localConfig.language});for(let e=i.length;e--;)if("jform[articletext]"===i[e].name){try{i[e].value=this.getBodyContent()}catch(e){}break}let s=this;function o(e){if(-1===e.indexOf("http")&&(e.indexOf("/"),e=s.pluginConfig.domain+e),s.validateUrl(e)){let t;jQuery.ajax({url:e,method:"post",timeout:1e4,dataType:"html",data:i,beforeSend:function(){t=new Date},success:function(n,o,r){if(200===r.status){s.page.time_to_first_byte=(new Date-t||1)/1e3;let o=jQuery(n),r=s.getValue("jform_pwtseo_articletitleselector");if(s.page.title=s.getArticleTitle(),0===s.page.title.length||r){let e=document.getElementById("jform_pwtseo_articletitleselector"),t=o.find(r||"H1, H2");t.length&&(s.page.title=t[0].textContent),e&&(!t.length&&r?e.className+=" pwtseo-error":e.className=e.className.replace(" pwtseo-error",""))}let a=n.match(/\<title\>(.*?)\<\/title\>/)||"";s.page.pagetitle=a?a[1]:s.getPageTitle(),s.page.body=s.getBodyContent(),s.page.final_html=n||s.getBodyContent();let l=n.indexOf("<body"),u=n.indexOf("</body>");s.page.final_body=n.substring(l,u+7)||s.page.body,0===s.page.body.length&&(s.page.body=s.page.final_body);let g=n.match(/\<meta name=["']description["']\s*content=["'](.*?)["']\s*\/\>/i);s.page.metadesc=g?g[1]:s.getMetaDescription(),s.page.metadata=n.match(/\<meta name=["'](.*?)["']\s*content=["'](.*?)["']\s*\/\>/gi)||[],s.page.url=decodeURIComponent(e),s.page.new_url=decodeURIComponent(e),s.page.error_global="",s.page.error="",s.replaceValue(i,{name:"jform[title]"},{name:"jform[title]",value:s.page.title},"name"),s.replaceValue(i,{name:"jform[metadesc]"},{name:"jform[metadesc]",value:s.page.metadesc},"name"),i.push({name:"find_unique",value:1}),document.querySelector("#jform_pwtseo_serptitle").value=s.page.pagetitle,document.querySelector("#jform_pwtseo_serpurl").value=s.page.new_url,document.querySelector("#jform_pwtseo_serpmetadescription").value=s.page.metadesc,jQuery.ajax({url:s.pluginConfig.frontajaxurl,method:"post",data:i,success:function(e){if(e&&!0===e.success){var t=e.data[0];s.page.title_unique=t.page_title_unique,s.page.metadesc_unique=t.page_metadesc_unique,s.page.new_url=s.pluginConfig.domain+decodeURIComponent(t.new_url||t.url),t.hasOwnProperty("count")&&(s.page.count=t.count),document.querySelector("#jform_pwtseo_serpurl").value=s.page.new_url}}})}},error:function(t){if(404===t.status&&"/"===e.slice(-1))return o(e.slice(0,-1));s.page.error_global=n(s.pluginConfig.resulting_page_unreachable,t.status,t.statusText),s.page.error=n(s.pluginConfig.resulting_page_unreachable,t.status,t.statusText)}})}else s.page.error_global=s.pluginConfig.error_invalid_url}if(s.page.title=s.getArticleTitle(),s.page.pagetitle=s.getPageTitle(),s.page.body=s.getBodyContent(),s.page.final_body="",s.page.final_html="",s.page.metadesc=s.getMetaDescription(),s.page.metadata=[],s.page.error="","com_pwtseo.custom"!==s.pluginConfig.context)!function(e){jQuery.ajax({url:s.pluginConfig.frontajaxurl,method:"post",data:e,beforeSend:function(){},complete:function(){},success:function(e){if(e&&!0===e.success){var t=e.data[0];s.page.count=t.count,s.page.reachable=t.reachable,s.page.url=t.url,s.page.intro_image=s.getValue("jform_images_image_intro"),s.page.intro_image_alt=s.getValue("jform_images_image_intro_alt"),s.page.full_image=s.getValue("jform_images_image_fulltext"),s.page.full_image_alt=s.getValue("jform_images_image_fulltext_alt"),o(t.url)}}})}(i);else{o(jQuery("#jform_url").val())}},500),addListener:function(e,t,i){let n=document.getElementById(e);n&&void 0!==n&&n.addEventListener(t,i)},getValue:function(e){return document.getElementById(e)&&void 0!==document.getElementById(e)?document.getElementById(e).value:""},calculateTotalScore:function(e){let t=_.findIndex(this.scores,["label",e.label]);t>-1?Vue.set(this.scores,t,e):this.scores.push(e)},getBodyContent:function(){let e,t=!1;"undefined"!=typeof tinyMCE&&(t=_.find(tinyMCE.editors,function(e){return"jform_articletext"===e.id&&!e.hidden}));try{e=t?t.getContent({format:"raw"}):this.getValue("jform_articletext")}catch(t){e=this.getValue("jform_articletext")}return e},validateUrl:function(e){return e.endsWith("/")||(e+="/"),0!==e.indexOf("http")||0===e.indexOf(this.pluginConfig.domain)},getArticleTitle:function(){return this.getValue("jform_title")||""},getPageTitle:function(){return"1"===this.getValue("jform_pwtseo_override_page_title")&&this.getValue("jform_pwtseo_page_title").length>0?this.getValue("jform_pwtseo_page_title"):this.getValue("jform_title")||""},getMetaDescription:function(){return this.getValue("jform_metadesc")||""},replaceValue:function(e,t,i,n){let s;for(s=0;s<e.length&&e[s][n]!=t[n];s++);s<e.length?e[s]=i:e.push(i)}},computed:{totalScore:function(){let e=this;return e.minscore=0,e.maxscore=0,this.score=this.scores.reduce(function(t,i){let n=i.score>0?i.score:0;return!1!==i.applyscore&&(e.minscore+=i.min*i.weight,e.maxscore+=i.max*i.weight,t+=n*i.weight),t},0),Math.round(100*this.score/this.maxscore)}},filters:{truncate:_.truncate},created:function(){jQuery('input[type="hidden"][id^="jform_pwtseo"].js-remove').remove(),this.getAjaxResponse(),this.pluginConfig=Joomla.getOptions("PWTSeoConfig");let e=this;setTimeout(function(){if(e.addListener("jform_title","keyup",e.getAjaxResponse),e.addListener("jform_alias","keyup",e.getAjaxResponse),e.addListener("jform_pwtseo_focus_word","keyup",e.getAjaxResponse),e.addListener("jform_metadesc","keyup",e.getAjaxResponse),e.addListener("jform_params_menu_meta_description","keyup",e.getAjaxResponse),e.addListener("jform_pwtseo_page_title","keyup",e.getAjaxResponse),e.addListener("jform_url","keyup",e.getAjaxResponse),e.addListener("jform_images_image_intro_alt","keyup",e.getAjaxResponse),e.addListener("jform_images_image_fulltext_alt","keyup",e.getAjaxResponse),e.addListener("jform_pwtseo_articletitleselector","keyup",e.getAjaxResponse),jQuery("[data-js-filter-datalayers]").on("click",function(){const e=jQuery("#jform_language").chosen().val();if(e&&e.length>0){const t=jQuery("#pwtseoTabContent div[data-js-lang]"),i=jQuery("#pwtseoTabTabs li");if(i.show(),t.show(),"*"!==e){const i=t.not("[data-js-lang='"+e+"'], [data-js-lang='*']");for(const e of i){const t=jQuery(e).parent().attr("id");jQuery('#pwtseoTabTabs a[href="#'+t+'"]').parent().hide()}i.hide()}for(const e of i)if(""===e.style.display||"block"===e.style.display){jQuery(e).find("a").trigger("click");break}}}),setInterval(function(){let t=e.getValue("jform_images_image_intro"),i=e.getValue("jform_images_image_fulltext");t===e.page.intro_image&&i===e.page.full_image||e.getAjaxResponse()},2e3),jQuery("#jform_pwtseo_override_page_title").chosen().change(e.getAjaxResponse),jQuery("#jform_metadata_robots").chosen().change(e.getAjaxResponse),jQuery("#jform_language").chosen().change(e.getAjaxResponse),e.pluginConfig.show_counters){let t=jQuery("#jform_title"),i=jQuery("#jform_metadesc"),n=jQuery("#jform_params_menu_meta_description"),s=jQuery("#jform_pwtseo_page_title"),o=Math.floor(e.pluginConfig.max_title_length),r=Math.floor(e.pluginConfig.max_metadesc_length);if(t&&t.length){let i=t.val().length>o?"red":"green";t.addClass("pseo-title").after('<span class="pseo-title-counter pwtseo-color-'+i+'"><span class="js-pwtseo-title-counter-amount">'+t.val().length+"</span>/"+o+"</span>"),e.addListener("jform_title","keyup",function(){document.querySelector(".js-pwtseo-title-counter-amount").innerHTML=this.value.length,this.value.length>o?jQuery("#jform_title + .pseo-title-counter").removeClass("pwtseo-color-green").addClass("pwtseo-color-red"):jQuery("#jform_title + .pseo-title-counter").removeClass("pwtseo-color-red").addClass("pwtseo-color-green")})}if(i&&i.length){let t=i.val().length>r?"red":"green";i.after('<span class="pseo-meta-counter pwtseo-color-'+t+'"><span class="js-pwtseo-metadescription-counter-amount ">'+i.val().length+"</span>/"+r+"</span>"),e.addListener("jform_metadesc","keyup",function(){document.querySelector(".js-pwtseo-metadescription-counter-amount").innerHTML=this.value.length,this.value.length>r?jQuery("#jform_metadesc + .pseo-meta-counter").removeClass("pwtseo-color-green").addClass("pwtseo-color-red"):jQuery("#jform_metadesc + .pseo-meta-counter").removeClass("pwtseo-color-red").addClass("pwtseo-color-green")})}if(n&&n.length){let t=n.val().length>r?"red":"green";n.after('<span class="pseo-meta-counter pwtseo-color-'+t+'"><span class="js-pwtseo-metadescription-counter-amount ">'+n.val().length+"</span>/"+r+"</span>"),e.addListener("jform_params_menu_meta_description","keyup",function(){document.querySelector(".js-pwtseo-metadescription-counter-amount").innerHTML=this.value.length,this.value.length>r?jQuery("#jform_params_menu_meta_description + .pseo-meta-counter").removeClass("pwtseo-color-green").addClass("pwtseo-color-red"):jQuery("#jform_params_menu_meta_description + .pseo-meta-counter").removeClass("pwtseo-color-red").addClass("pwtseo-color-green")})}if(s&&s.length){let t=s.val().length>o?"red":"green";s.after('<span class="pseo-title-counter pwtseo-color-'+t+'"><span class="js-pwtseo-pagetitle-counter-amount">'+s.val().length+"</span>/"+o+"</span>"),e.addListener("jform_pwtseo_page_title","keyup",function(){document.querySelector(".js-pwtseo-pagetitle-counter-amount").innerHTML=this.value.length,this.value.length>o?jQuery("#jform_pwtseo_page_title + .pseo-title-counter").removeClass("pwtseo-color-green").addClass("pwtseo-color-red"):jQuery("#jform_pwtseo_page_title + .pseo-title-counter").removeClass("pwtseo-color-red").addClass("pwtseo-color-green")})}}let t=!1,i=!1;document.getElementById("jform_articletext")&&("jce"===e.pluginConfig.editor_type?i=setInterval(function(){(t=_.find(tinyMCE.editors,function(e){return"jform_articletext"===e.id}))&&(clearInterval(i),t.onChange.add(e.getAjaxResponse))},200):"tinymce"===e.pluginConfig.editor_type?(t=_.find(tinyMCE.editors,function(e){return"jform_articletext"===e.id&&!e.hidden})).on("Change",e.getAjaxResponse):"none"===e.pluginConfig.editor_type&&e.addListener("jform_articletext","keyup",e.getAjaxResponse))},0);let t=setInterval(function(){let e=jQuery('a[href="#attrib-seofieldset"]');e.length&&(clearInterval(t),jQuery(e[0]).append(jQuery("<span />").attr("id","pwtseo__totalscore")))},200)},watch:{totalScore:function(){let e=jQuery("#pwtseo__totalscore"),t=this.totalScore;e.html(t).removeClass(function(e,t){return(t.match(/(^|\s)seoscore-\S+/g)||[]).join(" ")}).addClass(function(){return t<40?"seoscore-0":t<75?"seoscore-1":"seoscore-2"}),jQuery("#jform_pwtseo_pwtseo_score").val(t)}}})});